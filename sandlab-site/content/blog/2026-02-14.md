+++
title = "Bash scripting"
description = "Doing some bash scripting"
date = 2026-02-14
+++

Decided to try and automate the process of my creating my blog and note posts. 
Currently I need to go through the hassle of creating a file(!) and then adding the Zola meta data.
So, what a great opporunity to practice a bit of bash scripting.

First port of call, find a couple of helpful articles to get going;
- [The Bash Home page](https://www.gnu.org/software/bash/)
- [Ryan's Tutorials: Bash](https://ryanstutorials.net/bash-scripting-tutorial/)
- [Adding Arguments and options to your bash scripts](https://www.redhat.com/en/blog/arguments-options-bash-scripts)
- [Bash shebang explained](https://linuxize.com/post/bash-shebang/)

___

The basic idea is create a script that will;
- auto generate a markdown file in the appropriate folder
- populate it with Zola metadata
- use default values for the title and description
- take optional argument for adding a custom title
- take an optional argument for addign a custom description

To start with, I went create a file

```
touch post.sh
```

Start the file off with a shebang (`#!`), which is used to tell the operating system which interpreter to use to run parse the rest of the file.
This takes the form of `#!<interpereter> [arguments]`.
I chose to use the following shebang to make use of the `env` utility, hopefully maing this script more portable, i.e., it doesn't rely on bash being installed in `/bin/bash`.

```bash
#!/usr/bin/env bash
```

Before I try and take in a custom title and description, I'll set default values.

```bash
# Set variables
Title="New Blog Post"
Description="A new blog post, hopefully about something interesting"
```

Next up, make use of the `getopts` function, which is built into bash.

> NOTE: `getopts` not to be confused with `getopt`, which is an external program and not as portable with more invovled configuration (it can work differently depending what system you are on).

`getopts` allows parsing short aguments `-x [value]`, so I will use this for passing in a custom title `-t` and a custom description `-d`.
The script will loop through the options and and update the value of the title and description variable if they have been passed in. 
This looks something like this;

```bash
while getopts "t:d:" option; do
    case $option in
        t) Title=$OPTARG;;
        d) Description=$OPTARG;;
        \?) echo "Error: Invalid option"; exit;;
   esac
done
```

The full script for blog is;

```bash
#!/usr/bin/env bash
set -euo pipefail

###############################################################################
# Help                                                                        #
###############################################################################
Help()
{
    # Display help
    echo
    echo "HELP"
    echo
    echo "NAME"
    echo "  new-note"
    echo
    echo "SYNOPSIS"
    echo "  new-note [-tdh]"
    echo
    echo "DESCRIPTION"
    echo "  new-note.sh script used for generating a note file for the zola site"
    echo "  sandlab-site. The title, desciption and date metadata have default"
    echo "  values:"
    echo "      title => New Note"
    echo "      description => A new note about something noteworthy"
    echo "      date => today's date"
    echo
    echo "  options: -t, -d"
    echo "  -t    enter new title"
    echo "  -d    enter new description"
    echo
}

###############################################################################
###############################################################################
# CREATE A NEW NOTE IN SANDLAB-SITE                                           #
###############################################################################
###############################################################################

# Set variables
Title="New Blog Post"
Description="A new blog post, hopefully about something interesting"
Date="$(date '+%F')"
Draft="true"

while getopts ":ht:d:" option; do
    case $option in
        h) Help; exit;;
        t) Title=$OPTARG;;
        d) Description=$OPTARG;;
        \?) echo "Error: Invalid option"; Help; exit;;
   esac
done

# Navigate to file location
SCRIPT_DIR=$( cd "$(dirname "${BASH_SOURCE[0]}")" ; pwd -P )
TARGET_DIR="$SCRIPT_DIR/../sandlab-site/content/blog"
cd "$TARGET_DIR"

# Create file
FILE="$TARGET_DIR/blog.md"
if [[ -e "$FILE" ]]; then
  echo "Error: File already exists: $FILE" >&2
  exit 1
fi
touch blog.md

# Create file and add meta data
echo "+++" > blog.md
echo "title = "\""${Title}"\""" >> blog.md
echo "description = "\""${Description}"\""" >> blog.md
echo "date = ${Date}" >> blog.md
echo "draft = ${Draft}" >> blog.md
echo "+++" >> blog.md
```